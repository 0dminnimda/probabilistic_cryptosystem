# probabilistic_cryptosystem

This repository represents implementation and exploration of probabilistic cryptosystem(s)

## RSA-PSS Examples

### Send the message

```console
probabilistic_cryptosystem>python rsa_pss.py
Make output verbose? (0/1) [0]: 
Send message/Recieve message/Both? (s/r/b) [b]: s
Do you want to use random message? (0/1) [1]: 0
Then input the message: Hello world!
=============== Sender ===============
Sending: (b'Hello world!', 169422915862215550746811562525118779096709100859032062275970954510919200159898391913489161523950815221849440173302790075, (799026189383490785499821877342343431331286502580314632829221830081381671176787344789562862721354113698493297741244583317, 14927909303340714708611816182060775698763756516805141111599082503297365104775624882842657665513828021150757838545729340829))
```

### Recieve valid message

```console
probabilistic_cryptosystem>python rsa_pss.py
Make output verbose? (0/1) [0]: 
Send message/Recieve message/Both? (s/r/b) [b]: r
Then input the sent data: (b'Hello world!', 169422915862215550746811562525118779096709100859032062275970954510919200159898391913489161523950815221849440173302790075, (799026189383490785499821877342343431331286502580314632829221830081381671176787344789562862721354113698493297741244583317, 14927909303340714708611816182060775698763756516805141111599082503297365104775624882842657665513828021150757838545729340829))
=============== Reciever ===============
Valid
Hello world!
```

### Recieve invalid message

I only changed the last digit in the sent message from `9` to `8`

```console
probabilistic_cryptosystem>python rsa_pss.py
Make output verbose? (0/1) [0]: 
Send message/Recieve message/Both? (s/r/b) [b]: r
Then input the sent data: (b'Hello world!', 169422915862215550746811562525118779096709100859032062275970954510919200159898391913489161523950815221849440173302790075, (799026189383490785499821877342343431331286502580314632829221830081381671176787344789562862721354113698493297741244583317, 14927909303340714708611816182060775698763756516805141111599082503297365104775624882842657665513828021150757838545729340828))
=============== Reciever ===============
ERROR: 'w' is different for signature and current: OctetString[20](c3 c4 8b c8 52 e4 34 e8 80 cd dc 97 23 db 87 97 97 e0 20 d4) != OctetString[20](ad e7 f2 a5 c1 2a 93 d9 83 4e 77 52 81 71 d3 52 6f f5 2e d2)
Invalid
Hello world!
Traceback (most recent call last):
  File "C:\Python\projects\probabilistic_cryptosystem\rsa_pss.py", line 104, in <module>
    assert recieve(*data), "Message is invalid"
AssertionError: Message is invalid
```

### Verbose run for both operations

Airspeed velocity of an unladen swallow is 32.4 kilometers per hour

```console
probabilistic_cryptosystem>python rsa_pss.py
Make output verbose? (0/1) [0]: 1
Send message/Recieve message/Both? (s/r/b) [b]: b
Do you want to use random message? (0/1) [1]: 0
Then input the message: Airspeed velocity of an unladen swallow is 32.4 kilometers per hour
=============== Sender ===============
raw message: b'Airspeed velocity of an unladen swallow is 32.4 kilometers per hour'
octate message: OctetString[67](41 69 72 73 70 65 65 64 20 76 65 6c 6f 63 69 74 79 20 6f 66 20 61 6e 20 75 6e 6c 61 64 65 6e 20 73 77 61 6c 6c 6f 77 20 69 73 20 33 32 2e 34 20 6b 69 6c 6f 6d 65 74 65 72 73 20 70 65 72 20 68 6f 75 72)
octate pss signature: OctetString[50](bc 9f 90 e3 dc e8 92 1a 69 c9 5d b6 cf e3 6c 7a a0 32 1f 5f 6d 68 aa 3a 2f 76 4e bf 1a d3 df 02 7f 9f 7d 43 10 5d fd 90 ad d6 77 a2 32 21 99 af 1e 9d)
number pss signature: 1584854520262234368648907844680411664854089733377070471787200195976175594954539883078809859953827433594910439554273025980
public rsa key: (3877792609933753567216488594556388738353699628807800576118962811110189555008427674761117247211043225414043004031696289367, 7947650513171287741376623200064514407165361284441639717567104782474146443360770679601188048507775138071897372090854887523)
private rsa key: (3572924479608614474551743430734055598733081641239373447396707213501524848157612365354131559362779685759968847424481836023, 7947650513171287741376623200064514407165361284441639717567104782474146443360770679601188048507775138071897372090854887523)
rsa signature: 7386746461585048676067387479651844868198821297459981298676427848932179246513460024713931699628121035999122014403697689150
Sending: (b'Airspeed velocity of an unladen swallow is 32.4 kilometers per hour', 7386746461585048676067387479651844868198821297459981298676427848932179246513460024713931699628121035999122014403697689150, (3877792609933753567216488594556388738353699628807800576118962811110189555008427674761117247211043225414043004031696289367, 7947650513171287741376623200064514407165361284441639717567104782474146443360770679601188048507775138071897372090854887523))
=============== Reciever ===============
rsa signature: 1584854520262234368648907844680411664854089733377070471787200195976175594954539883078809859953827433594910439554273025980
octate message: OctetString[67](41 69 72 73 70 65 65 64 20 76 65 6c 6f 63 69 74 79 20 6f 66 20 61 6e 20 75 6e 6c 61 64 65 6e 20 73 77 61 6c 6c 6f 77 20 69 73 20 33 32 2e 34 20 6b 69 6c 6f 6d 65 74 65 72 73 20 70 65 72 20 68 6f 75 72)
number pss signature: OctetString[50](bc 9f 90 e3 dc e8 92 1a 69 c9 5d b6 cf e3 6c 7a a0 32 1f 5f 6d 68 aa 3a 2f 76 4e bf 1a d3 df 02 7f 9f 7d 43 10 5d fd 90 ad d6 77 a2 32 21 99 af 1e 9d)
Valid
Airspeed velocity of an unladen swallow is 32.4 kilometers per hour
```
